<!doctype html><html lang="ja"><head><meta charset="UTF-8" /><meta name="viewport" content="width = device-width, initial-scale = 1, user-scalable = yes" /><link rel="stylesheet" type="text/css" href="css/style.css" /><title>MYAO's WEBSITEサブクラスのインスタンスをスーパークラスの変数に代入した時の話</title></head><body><header id="main-header"><h1><a href="./index.html">MYAO's WEBSITE</a></h1></header><main><header id="article-header"><div id="date">2017-01-11</div><h2 id="title">サブクラスのインスタンスをスーパークラスの変数に代入した時の話</h2></header><div id="article-main"><p>タイトルの言い方でええのんかわからんけど、Javaであるクラスを継承したクラスを親クラスの型を持つ? 変数に代入した時の話。 </p><pre><code>// Sub.java  
public class Sub extends Super{  
  /**  
     Print "piyo" to the standard output.  
  */  
  @Override  
  public void piyo(){  
    System.out.println("piyo");  
  }  
  /**  
     Print "FUGA" to the standard output.  
     Super class dosen't hava this method.  
  */  
  public void fuga(){  
    System.out.println("FUGA");  
  }  
}  
 
//Super.java  
public class Super {  
  /**  
     Print "HOGE" to the standard output.  
  */  
  public void hoge(){  
    System.out.println("HOGE");  
  }  
  /**  
     Print "PIYO" to the standard output.  
  */  
  public void piyo(){  
    System.out.println("PIYO");  
  }    
}  
 
// SubclassTest.java  
public class SubclassTest {  
    public static void main(String[] args){  
        Super superClass = new Super();  
        Sub subClass = new Sub();  
        Super subSuperClass = new Sub();  
 
        System.out.println("Super:");  
        superClass.hoge();  
        superClass.piyo();  
        System.out.println("Sub(Sub):");  
        subClass.hoge();  
        subClass.piyo();  
        subClass.fuga();  
        System.out.println("Sub(Super):");  
        subSuperClass.hoge();  
        subSuperClass.piyo(); // 変数がSuperクラスでもオーバーライドされる。  
        // subSuperClass.fuga(); // Superクラスがfugaメソッドを持ってないのでエラー。  
        ((Sub)subSuperClass).fuga(); //キャストすればOK。  
        System.out.println(subSuperClass instanceof Sub); //trueと印字される。  
    }  
} </code></pre><p>例によって、シンタックスハイライトしていないのはご勘弁を。で、まあ上のようなことを考えました。コメントのとおりですが。 </p><p>SuperというクラスをSubというクラスが継承していて、piyoというメソッドをオーバーライドして、Superというクラスにはないfugaというクラスを持っています。hogeはSuperというクラスの中でのみ定義されています。 </p><p>この時、Subクラスの変数にSubのコンストラクタで作ったインスタンスを代入すると、次のようになりました。 </p><ul><li>hogeメソッドを呼び出せる。Superクラスで定義されたとおりの結果になる。</li><li>piyoメソッドを呼び出せる。Subクラスで定義した動作にオーバーライドされている。</li><li>fugaメソッドを呼び出せる。</li></ul><p>となりますが、Superクラスの変数にSubクラスのコンストラクタで作ったインスタンスを代入すると、次のように変わります。 </p><ul><li>hogeメソッドを呼び出せる。Superクラスで定義されたとおりの結果になる。(同じ)</li><li>piyoメソッドを呼び出せる。Subクラスで定義した動作にオーバーライドされている。(同じ)</li><li>fugaメソッドを呼び出せない。(Superクラスがfugaメソッドを持っていないためだと思われる。)</li></ul><p>ってな具合になります。変数の方が型をもってるのかなと思いきや、System.out.println(subSuperClass instanceof Sub)では、trueが返ってきます。理由を推測できないわけでもないですけれども、なんとなくややこしい感じがしたので、メモ代わりに。 </p></div><footer id="article-header">UP: <a href="diary.html">diary</a> PREV: <a href="20170111.html">20170111</a> NEXT: <a href="20170116.html">20170116</a></footer></main><footer id="main-footer"><div id="icnos"><a href="https://twitter.com/myao_s_moking"><img src="img/twit.png" class="icon-img" /></a><a href="https://github.com/myaosato"><img src="img/github.png" class="icon-img" /></a></div><div id="copyright">&copy;2010 Satoaki Miyao</div></footer></body></html>