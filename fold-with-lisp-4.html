<!doctype html><html lang="ja"><head><meta charset="UTF-8" /><meta name="viewport" content="width = device-width, initial-scale = 1, user-scalable = yes" /><link rel="stylesheet" type="text/css" href="css/style.css" /><title>訥弁日記 - 重畳関数について with Common Lisp part4</title></head><body><header id="main-header"><h1><a href="./index.html">訥弁日記</a></h1></header><main><header id="article-header"><div id="date">2018-12-13</div><h2 id="title">重畳関数について with Common Lisp part4</h2></header><div id="article-main"><p>この記事は第8回関西Lispユーザ会で話す予定の内容をまとめているものです。 </p><p>このシリーズでは、Common Lispを使って重畳関数を実装し、またリスト意外のデータ構造に対しても重畳関数を一般化することで、重畳関数とは何かについて考えて行こうと思います。 ここでは、重畳関数という言葉はリストに対するものに限らないとして使うものとします。 </p><p>なにかありましたら、<a href="https://twitter.com/myao_s_moking/">@myao_s_moking</a>まで、ご連絡頂けると幸いです。優しく教えてね。 </p><p>今回は、おまけ回です。 </p><p>最初に書いておきますが、うまくまとまりませんでした。すみません。 でも書きたいので書きました。 </p><p>今回は、前回まで書いてきた重畳関数の数学的な対応物について書きます。 が、筆者の力不足のために、この記事で十分な説明が出来るとも思えないので、あまり、まともに説明する気がないです。 まともなものも書きたいなと思いますが、それは違う機会にします。 </p><p>ここでは、ポエム的に言葉を使ってキーワードを挙げていくという形をとりますので、そのつもりでお願いします。 以下、各概念をなんとなくのイメージで説明しますが、数学的に大事なことは定義をしっかりと確認することなので、 私のふわっとした説明は聞き流して、各自勉強をされる際には、きっちりした文献にあたることをオススメします。 </p><p>参考に、動画を挙げておきます。 </p><p><a href="https://www.youtube.com/watch?v=j3bY_djVjiQ">第7回圏論勉強会@ワークスアプリケーションズ</a> </p><p>この動画の後半部分に感動したので、今回の記事を書こうという気になりました。 </p><p><a href="https://www.youtube.com/watch?v=YzSAo-EvhfA">圏論で考えよう01、導入</a> </p><p>こちらの動画で、可換図式をちゃんと書いて考えようということをおっしゃっていた事を実践していく中で、色々理解できるようになったので、こちらもおすすめです。 </p><h3>圏論</h3><p>圏論とは数学の一つの分野です。 適当な説明ではないかもしれませんが、モノの内部の構造を調べ性質を解き明かす従来型の数学に対して、モノの構造には触れない代わりにモノ同士の関係性からその性質を探るというようなアプローチをとります。 モノの内部の構造には着目せず、それらの関係性に着目するという抽象化によって、強力な一般化が出来て成功している学問だと思います。(まあ、ほんまのところは、知らんけど) </p><p>圏論の数式は、ラベル(アルファベットや記号が使われる)とラベル間の矢印を用いて書かれます。次のWikipedia記事を参考にしてください。<a href="https://ja.wikipedia.org/wiki/%E5%8F%AF%E6%8F%9B%E5%9B%B3%E5%BC%8F">可換図式</a> モノのことを対象、その関係(矢印)のことを射と呼びます。 </p><p>上で挙げた記事の中に出てくる図を用いてモノ同士の関係性から何が結論付けられるかを調べます。 </p><p>プログラマの界隈でも、関数型言語の普及と共にその言葉が語られるようになっている様です。 その文脈では、型や主に関数型言語で用いられるモナドというデータ構造が話題の中心となるようです。 </p><p>もちろんデータ構造に名前を付けるということは型を定義しているということとあまり違いは無い気もしますが、 Common Lispという動的な型付けな言語で圏論の話をするというのはなかなかおもしろいのでは無いかなと思ったことが、今回のシリーズのきっかけでした。 まあ、ホントのところはコンストラクタの引数の型については、終始ごまかした書き方をしているわけではありますが。 </p><p>さて、圏論の中で出てくるF-始代数とcatamorphismと言われる概念が、今まで書いてきた重畳関数そのものとなっています。 </p><h3>F-始代数とcatamorphism</h3><p>F-始代数という概念が圏論にあります。その正確な定義は、最初にも述べたとおりここでは、書きません。 </p><p>イメージだけ述べていきます。 </p><p>データ構造がコンストラクタとその逆関数を通して引数の世界と一対一に対応することを前回まで見てきましたが、 これと同じように対象Xと対象F(X)が射inとその逆射を通して一対一に対応をしている状況を考えます。 </p><p>この時F()という記号は、コンストラクタの引数の在り方、順番と何番目にどの様なものが期待されるかを表しています。 F(A)という書き方は、例えばリストのコンストラクタの引数のうちリストを期待していた箇所が、Aというモノを期待している状況のことと考えてください。 </p><p>F(A)が引数を表して、その返り値がAとなる関数というのは、前回まで見てきた重畳関数に与えた関数のことです。 </p><pre><code>CL-USER&gt; (defun fold-list (func1 func2 list)  
               (if (null list)  
                   (funcall func2)  
                   (funcall func1 (car list) (fold-list func1 func2 (cdr list)))))  
FOLD-LIST  
CL-USER&gt; </code></pre><p>つまり、これの、func1 と func2に対応します。 </p><p>コンストラクタの引数の形を与えると再帰的なデータ構造が決まります。前回まででも、リストや木構造などを定義しました。 説明の上では言葉で先に書いているように見えるかもしれませんが、例えばリストの構造というのはcons nil(を返す定数関数)が決めていることが分かるかと思います。 </p><p>つまりFというコンストラクタの引数の在り方を定義する関数のようなものによって、データ構造が特定されます。 ただ、このコンストラクタとデータ構造には条件があって、その条件はコンストラクタとその逆関数があることです。 (前回まで見てきたデータ構造はすべてそれを満たします。 </p><p>実はFを与えることで、これを満たす様な対象X(と射in)は唯一つ決まります。(正確には区別できないモノが複数ある場合もあるがここでは無視する。) </p><p>Fに対してこのXとinを、F-始代数と呼びます。(Xがデータ構造、inがコンストラクタ、F(X)がコンストラクタの引数に対応します。) </p><p>一般の対象Aに関してF(A)とAとその間の射fは、上で述べたように重畳関数に与える関数と重畳関数の返り値として期待されるような値に対応しています。これらをF-代数と呼びます。 リストのようなデータ構造はその中で特別なものという感じです。 </p><p>そろそろ、なんのことかわからなくなってきていると思います。もう、私も書きたいから書いているだけになってきていますが、もう少しで終わります。 </p><p>実は圏論の結果によって、F-代数とF-始代数が満たすべき式があることが分かります。 </p><pre><code>  X -- in^-1 -&gt; F(X)  
  |              |  
 p(f)           F(p(f))  
  |              |  
  V              V  
  A &lt;-- f ----- F(A)  
</code></pre><p>AAで書くとこんな感じ。 </p><p>それを用いると前回まで書いてきたように重畳関数p(f)は、 コンストラクタの逆in^-1で引数F(X)を取り出して、重畳関数の再帰F(p(f))部分を呼び出した後に、再び重畳関数に与えた関数fで組み直すものと等しいということが分かります。 </p><h3>終わりに</h3><p>自分の実力不足で、説明がどうもうまく出来ませんでした。そのうち何かの形でリベンジしたいと思います。 関西Lispユーザ会の発表では、もう少しマシにしゃべることが出来たらいいなと思います。 </p></div><footer id="article-footer">UP: <a href=".html"></a> PREV: <a href="fold-with-lisp-3.html">fold-with-lisp-3</a> NEXT: <a href=".html"></a></footer></main><footer id="main-footer"><div id="icons"><a href="https://twitter.com/myao_s_moking"><img src="img/twit.png" class="icon-img" /></a><a href="https://github.com/myaosato"><img src="img/github.png" class="icon-img" /></a></div><div id="copyright">&copy;2010 Satoaki Miyao</div></footer></body></html>