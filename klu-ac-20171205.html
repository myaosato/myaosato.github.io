<!doctype html><html lang="ja"><head><meta charset="UTF-8" /><meta name="viewport" content="width = device-width, initial-scale = 1, user-scalable = yes" /><link rel="stylesheet" type="text/css" href="css/style.css" /><title>無門関 - WRITE関数のオプショナル引数</title></head><body><header id="main-header"><h1><a href="./index.html">無門関</a></h1></header><main><header id="article-header"><div id="date">2017-12-03</div><h2 id="title">WRITE関数のオプショナル引数</h2></header><div id="article-main"><p><a href="https://adventar.org/calendars/2490">関西Lispユーザ会アドベントカレンダー</a>の5日目です。昨日は、nz-tcoderさんの<a href="https://nz-tcoder.github.io/memo/2017/how-to-use-2/">これってどう使うの？(2)</a>でした。 </p><p>1日目で、書いたWRITEのオプショナル引数の続きです。 Common Lispの単純な出力関数WRITE。この関数は、豊富なオプショナル引数を取ります。 </p><ul><li>array</li><li>base</li><li>case</li><li>circle</li><li>escape</li><li>gensym</li><li>length</li><li>level</li><li>lines</li><li>miser-width</li><li>pprint-dispatch</li><li>pretty</li><li>radix</li><li>readably</li><li>right-margin</li></ul><p>ということを最近知りましたという内容が<a href="./klu-ac-20171201.html">この間</a>の記事でした。base, escape, radix, readbalyについては、少し取り上げました、今日は、他のオプションについても見ていきたいと思います。 </p><pre><code>(write #(1 2 3) :array nil)  
&gt;&gt; #&lt;(SIMPLE-VECTOR 3) {1003B8287F}&gt;  
 
(write #(1 2 3) :array t)  
&gt;&gt; #(1 2 3) </code></pre><p>arrayはarrayを表示させるかどうかのオプションです。 上の例のような感じ。(SBCLで試しています。 </p><pre><code>(write 'This-is-a-pen. :case :upcase)  
&gt;&gt; THIS-IS-A-PEN.  
(write 'This-is-a-pen. :case :downcase)  
&gt;&gt; this-is-a-pen.  
(write 'This-is-a-pen. :case :capitalize)  
&gt;&gt; This-Is-A-Pen. </code></pre><p>caseは、シンボル名の表示時に、大文字小文字の制御を行います。 </p><pre><code>(write (gensym) :gensym nil)  
&gt;&gt; G735  
(write (gensym) :gensym t)  
&gt;&gt; #:G735 </code></pre><p>gensymは(gensym)で作られたシンボルを表す文字列の前に#:が付け加えられます。 </p><pre><code>(write '(0 1 2 3 4 5 6 7 8 9) :length 5)  
&gt;&gt; (0 1 2 3 4 ...)  
(write '(0 (1 (2 (3 (4 (5 (6 (7 (8 (9)))))))))) :level 5)  
&gt;&gt; (0 (1 (2 (3 (4 #))))) </code></pre><p>lengthはリストやベクタの長さ、levelはネストの深さの制御ですね。 </p><pre><code>(write '(if hoge piyo fuga) :pretty nil)  
&gt;&gt; (IF HOGE PIYO FUGA)  
(write '(if hoge piyo fuga) :pretty t)  
&gt;&gt; (IF HOGE  
       PIYO  
       FUGA)  
(write '(if hoge piyo fuga) :lines 3)  
&gt;&gt; (IF HOGE  
       PIYO  
       FUGA)  
(write '(if hoge piyo fuga) :lines 2)  
&gt;&gt; (IF HOGE  
       PIYO ..) </code></pre><p>prettyはプリティプリントの有夢の制御、linesはプリティプリントの行数の制御ですね。 </p><p>miser-width, right-margin, pprint-dispatchもプリティプリントの制御らしい。なんだか、すごいがこの３つはよくわからんかった。pprint-dispatchは結構使えそうなのだけど、pprint dispatch tableをどうやって作ったり制御したら良いのかよく分からなかった。また調べたい。 </p><pre><code>(let ((a (list 1 2 3)))  
  (setf (cdddr a) a)  
  (write a :circle t)  
  :done)  
&gt;&gt; #1=(1 2 3 . #1#) </code></pre><p>最後は、circle。tを与えると、循環リスト(に限らない循環構造な気がするけど、ちょっとよくわからない)を表示することが出来るようになります。うーん、ほんとに色々あるんですねぇという感じです。これだけ色々オプションが有って、文字列の出力というのは、大事なことなんだなぁと改めて思った次第です。そういやformatも色々あるよなぁ。まあ、それは別の機会に。 </p><p>明日は、fu7mu4さんの関西Lispユーザ会の紹介(仮)です。 </p></div><footer id="article-footer">UP: <a href=".html"></a> PREV: <a href=".html"></a> NEXT: <a href=".html"></a></footer></main><footer id="main-footer"><div id="icons"><a href="https://twitter.com/myao_s_moking"><img src="img/twit.png" class="icon-img" /></a><a href="https://github.com/myaosato"><img src="img/github.png" class="icon-img" /></a></div><div id="copyright">&copy;2010 Satoaki Miyao</div></footer></body></html>